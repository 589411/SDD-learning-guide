# 🐛 錯誤訊息速查

這份速查表整理了學習過程中最常遇到的錯誤訊息及解決方法。

**使用方法：** 用 `Cmd/Ctrl + F` 搜尋你的錯誤訊息關鍵字

---

## 📋 錯誤分類

- [Node.js / npm 錯誤](#nodejs--npm-錯誤)
- [Git 錯誤](#git-錯誤)
- [Jest 測試錯誤](#jest-測試錯誤)
- [JavaScript 執行錯誤](#javascript-執行錯誤)
- [模組引入錯誤](#模組引入錯誤)

---

## Node.js / npm 錯誤

### ❌ npm : command not found

**錯誤訊息：**
```
npm : command not found
```
或
```
'npm' is not recognized as an internal or external command
```

**原因：** Node.js 未安裝或未加入環境變數

**解決方法：**

1. **檢查是否已安裝**
```bash
node --version
npm --version
```

2. **未安裝則下載安裝**
- 訪問：https://nodejs.org/
- 下載 LTS 版本
- 重新啟動終端機

3. **已安裝但找不到（環境變數問題）**
```bash
# Mac/Linux
echo 'export PATH="/usr/local/bin:$PATH"' >> ~/.zshrc
source ~/.zshrc

# Windows：重新安裝 Node.js 並勾選「Add to PATH」
```

---

### ❌ EACCES: permission denied

**錯誤訊息：**
```
Error: EACCES: permission denied, access '/usr/local/lib/node_modules'
```

**原因：** 權限不足

**解決方法：**

**方法 1：使用 sudo（臨時）**
```bash
sudo npm install -g <package>
```

**方法 2：修改 npm 全域套件目錄（推薦）**
```bash
# 1. 建立全域套件目錄
mkdir ~/.npm-global

# 2. 設定 npm
npm config set prefix '~/.npm-global'

# 3. 加入環境變數
echo 'export PATH=~/.npm-global/bin:$PATH' >> ~/.zshrc
source ~/.zshrc
```

---

### ❌ ERESOLVE unable to resolve dependency tree

**錯誤訊息：**
```
npm ERR! code ERESOLVE
npm ERR! ERESOLVE unable to resolve dependency tree
```

**原因：** 套件版本衝突

**解決方法：**

**方法 1：使用 --legacy-peer-deps**
```bash
npm install --legacy-peer-deps
```

**方法 2：使用 --force（不推薦）**
```bash
npm install --force
```

**方法 3：更新 npm**
```bash
npm install -g npm@latest
```

---

### ❌ npm ERR! code ENOTFOUND

**錯誤訊息：**
```
npm ERR! code ENOTFOUND
npm ERR! network request to https://registry.npmjs.org/xxx failed
```

**原因：** 網路問題或 npm registry 連線失敗

**解決方法：**

1. **檢查網路連線**

2. **更換 npm registry（中國地區）**
```bash
npm config set registry https://registry.npmmirror.com
```

3. **清除快取**
```bash
npm cache clean --force
```

4. **使用 VPN（如果是區域限制）**

---

## Git 錯誤

### ❌ Please tell me who you are

**錯誤訊息：**
```
*** Please tell me who you are.

Run
  git config --global user.email "you@example.com"
  git config --global user.name "Your Name"
```

**原因：** 未設定 Git 使用者資訊

**解決方法：**
```bash
git config --global user.name "你的名字"
git config --global user.email "your.email@example.com"

# 驗證設定
git config --list
```

---

### ❌ fatal: not a git repository

**錯誤訊息：**
```
fatal: not a git repository (or any of the parent directories): .git
```

**原因：** 目前目錄不是 Git 儲存庫

**解決方法：**

**情況 1：想初始化 Git**
```bash
git init
```

**情況 2：在錯誤的目錄**
```bash
# 確認目前位置
pwd

# 切換到正確的專案目錄
cd /path/to/your/project
```

---

### ❌ error: failed to push some refs

**錯誤訊息：**
```
error: failed to push some refs to 'https://github.com/xxx/xxx.git'
hint: Updates were rejected because the remote contains work that you do
hint: not have locally.
```

**原因：** 遠端有本地沒有的更新

**解決方法：**

**方法 1：先拉取再推送（推薦）**
```bash
git pull origin main
git push origin main
```

**方法 2：強制推送（危險！會覆蓋遠端）**
```bash
git push -f origin main  # 小心使用！
```

---

### ❌ Your branch is ahead of 'origin/main' by X commits

**訊息：**
```
Your branch is ahead of 'origin/main' by 2 commits.
  (use "git push" to publish your local commits)
```

**原因：** 本地有未推送的提交

**解決方法：**
```bash
# 推送到遠端
git push origin main
```

---

## Jest 測試錯誤

### ❌ Cannot find module

**錯誤訊息：**
```
Cannot find module '../src/example' from 'tests/example.test.js'
```

**原因：** 檔案路徑錯誤或檔案不存在

**解決方法：**

1. **確認檔案存在**
```bash
ls src/example.js
```

2. **檢查路徑**
```javascript
// 錯誤
const { func } = require('./src/example');  // 少了 ../

// 正確
const { func } = require('../src/example');
```

3. **檢查副檔名**
```javascript
// 不需要副檔名
const { func } = require('../src/example');  // ✓
const { func } = require('../src/example.js');  // 也可以
```

4. **檢查匯出**
```javascript
// src/example.js
// 確認有 module.exports
module.exports = { func };
```

---

### ❌ Test suite failed to run

**錯誤訊息：**
```
Test suite failed to run

SyntaxError: Unexpected token 'export'
```

**原因：** Jest 無法解析 ES6 import/export

**解決方法：**

**方法 1：使用 CommonJS（推薦新手）**
```javascript
// 使用 require 和 module.exports
const { func } = require('../src/example');
module.exports = { func };
```

**方法 2：設定 Babel**
```bash
npm install --save-dev @babel/preset-env
```

建立 `babel.config.js`:
```javascript
module.exports = {
  presets: [['@babel/preset-env', {targets: {node: 'current'}}]],
};
```

---

### ❌ expect(...).toBe() failed

**錯誤訊息：**
```
expect(received).toBe(expected)

Expected: { value: 1 }
Received: { value: 1 }
```

**原因：** 物件比較使用了 `toBe`（嚴格相等）

**解決方法：**
```javascript
// 錯誤：物件不能用 toBe
expect(result).toBe({ value: 1 });  // ✗

// 正確：物件要用 toEqual
expect(result).toEqual({ value: 1 });  // ✓

// toBe 用於原始值
expect(result).toBe(1);  // ✓
expect(result).toBe('hello');  // ✓
expect(result).toBe(true);  // ✓
```

---

### ❌ Timeout - Async callback was not invoked

**錯誤訊息：**
```
Timeout - Async callback was not invoked within the 5000 ms timeout
```

**原因：** 異步測試未正確處理

**解決方法：**

**方法 1：使用 async/await**
```javascript
// 錯誤
test('async test', () => {
  fetchData().then(data => {
    expect(data).toBeDefined();
  });
});

// 正確
test('async test', async () => {
  const data = await fetchData();
  expect(data).toBeDefined();
});
```

**方法 2：使用 done callback**
```javascript
test('async test', (done) => {
  fetchData().then(data => {
    expect(data).toBeDefined();
    done();  // 通知 Jest 測試完成
  });
});
```

**方法 3：增加超時時間**
```javascript
test('slow test', async () => {
  // test code
}, 10000);  // 10 秒超時
```

---

## JavaScript 執行錯誤

### ❌ TypeError: Cannot read property 'xxx' of undefined

**錯誤訊息：**
```
TypeError: Cannot read property 'name' of undefined
```

**原因：** 試圖讀取 undefined 的屬性

**解決方法：**

1. **檢查物件是否存在**
```javascript
// 錯誤
const name = user.name;  // user 是 undefined

// 正確：先檢查
if (user) {
  const name = user.name;
}

// 或使用可選鏈 (Optional Chaining)
const name = user?.name;
```

2. **使用預設值**
```javascript
const user = getUser() || {};
const name = user.name || 'Anonymous';
```

3. **加入 console.log 除錯**
```javascript
const user = getUser();
console.log('user:', user);  // 檢查 user 的值
const name = user.name;
```

---

### ❌ TypeError: xxx is not a function

**錯誤訊息：**
```
TypeError: xxx is not a function
```

**原因：** 試圖呼叫不是函數的東西

**解決方法：**

1. **檢查函數名稱拼寫**
```javascript
// 錯誤
const result = calculateTotla();  // 拼錯了

// 正確
const result = calculateTotal();
```

2. **確認匯出/引入**
```javascript
// 匯出
module.exports = { calculateTotal };  // 物件形式

// 引入
const { calculateTotal } = require('./utils');  // 解構
```

3. **檢查是否真的是函數**
```javascript
console.log(typeof calculateTotal);  // 應該顯示 'function'
```

---

### ❌ ReferenceError: xxx is not defined

**錯誤訊息：**
```
ReferenceError: xxx is not defined
```

**原因：** 使用了未宣告的變數

**解決方法：**

1. **確認變數有宣告**
```javascript
// 錯誤
console.log(name);  // name 未宣告

// 正確
const name = 'Alice';
console.log(name);
```

2. **檢查作用域**
```javascript
if (true) {
  const name = 'Alice';
}
console.log(name);  // 錯誤！name 在 if 區塊內

// 正確
const name = 'Alice';
if (true) {
  console.log(name);  // ✓
}
```

3. **檢查拼字**
```javascript
const userName = 'Alice';
console.log(username);  // 錯誤！大小寫不同
```

---

### ❌ SyntaxError: Unexpected token

**錯誤訊息：**
```
SyntaxError: Unexpected token {
```

**原因：** 語法錯誤

**常見情況：**

1. **缺少逗號**
```javascript
// 錯誤
const obj = {
  name: 'Alice'
  age: 30  // 缺少逗號
};

// 正確
const obj = {
  name: 'Alice',
  age: 30
};
```

2. **括號不匹配**
```javascript
// 錯誤
function example() {
  if (true) {
    console.log('test');
  // 缺少 }
}

// 正確
function example() {
  if (true) {
    console.log('test');
  }
}
```

3. **非法字元**
```javascript
// 錯誤：全形符號
const name = "Alice"；  // 中文分號

// 正確
const name = "Alice";  // 英文分號
```

---

## 模組引入錯誤

### ❌ module.exports is not defined

**錯誤訊息：**
```
ReferenceError: module is not defined
```

**原因：** 在瀏覽器環境或 ES6 模組中使用 CommonJS 語法

**解決方法：**

**Node.js 環境（後端）：**
```javascript
// 使用 CommonJS
module.exports = { func };
const { func } = require('./module');
```

**瀏覽器/現代 JS（前端）：**
```javascript
// 使用 ES6 模組
export { func };
import { func } from './module';
```

---

### ❌ require is not defined

**錯誤訊息：**
```
ReferenceError: require is not defined
```

**原因：** 在 ES6 模組中使用 CommonJS

**解決方法：**

改用 ES6 import：
```javascript
// 錯誤
const { func } = require('./module');

// 正確
import { func } from './module';
```

或設定 package.json：
```json
{
  "type": "module"
}
```

---

## 🔍 通用除錯技巧

### 技巧 1：仔細閱讀錯誤訊息

錯誤訊息通常包含：
- 📁 **檔案名稱**
- 📍 **行號**
- 💬 **錯誤類型**
- 💡 **提示訊息**

**範例：**
```
/Users/xxx/project/src/example.js:15
    console.log(name);
                ^
ReferenceError: name is not defined
    at Object.<anonymous> (/Users/xxx/project/src/example.js:15:17)
```

分析：
- 檔案：`src/example.js`
- 行號：第 15 行
- 問題：變數 `name` 未定義

### 技巧 2：使用 console.log

在可疑的地方加入 console.log：
```javascript
function calculateTotal(items) {
  console.log('calculateTotal called');
  console.log('items:', items);
  
  let total = 0;
  items.forEach(item => {
    console.log('processing item:', item);
    total += item.price;
  });
  
  console.log('total:', total);
  return total;
}
```

### 技巧 3：逐步簡化

把複雜的程式碼簡化到最簡單的版本：
```javascript
// 複雜版本（有 bug）
function complex() {
  // 50 行程式碼
}

// 簡化版本（測試基本邏輯）
function complex() {
  console.log('function called');
  return 'test';
}
```

一旦簡化版本能運作，再逐步加入功能。

### 技巧 4：搜尋錯誤訊息

複製完整的錯誤訊息到 Google：
```
"Cannot find module '../src/example'" jest
```

通常能找到相同問題的解決方案。

### 技巧 5：使用 AI 協助

詢問 ChatGPT/Claude：
```
我遇到以下錯誤：
[貼上錯誤訊息]

這是我的程式碼：
[貼上相關程式碼]

請幫我：
1. 解釋錯誤原因
2. 提供解決方法
3. 給我修正後的程式碼
```

---

## 💡 預防錯誤的好習慣

### 1. 頻繁測試
```
寫一點程式碼 → 執行測試 → 確認正常 → 繼續
```
不要寫完一大段才測試。

### 2. 使用 Linter
```bash
npm install --save-dev eslint
```
自動檢查程式碼錯誤。

### 3. 閱讀文件
遇到新的 API，先看官方文件。

### 4. 寫註解
```javascript
// 計算購物車總金額
// @param {Array} items - 商品陣列
// @returns {number} 總金額
function calculateTotal(items) {
  // ...
}
```

### 5. 版本控制
頻繁 commit，方便回溯：
```bash
git add .
git commit -m "新增功能X"
```

---

## 📚 延伸資源

- [MDN Web Docs](https://developer.mozilla.org/) - JavaScript 官方文件
- [Stack Overflow](https://stackoverflow.com/) - 問題解答社群
- [Node.js 官方文件](https://nodejs.org/docs/)
- [Jest 官方文件](https://jestjs.io/docs/getting-started)

---

**找不到你的錯誤？**  
試試：
1. 複製錯誤訊息到 Google 搜尋
2. 向 AI 詢問（ChatGPT/Claude）
3. 查閱 [常見問題FAQ](./常見問題FAQ.md)

祝你除錯順利！🐛➡️✨

