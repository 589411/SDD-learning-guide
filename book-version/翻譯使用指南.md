# 🤖 自動翻譯使用指南

## 📋 概述

已為你建立完整的**自動翻譯系統**，使用 **Gemini API** 將中文內容翻譯成英文。

**優勢：**
- ✅ 完全自動化
- ✅ 保持格式和程式碼
- ✅ 術語一致性
- ✅ 快速完成（10-30 分鐘）
- ✅ 成本低廉（免費或 $0.50-2）

---

## 🚀 快速開始（3 步驟）

### 步驟 1：取得 Gemini API Key

1. **前往 Google AI Studio**
   ```
   https://makersuite.google.com/app/apikey
   ```

2. **登入 Google 帳號**

3. **點擊「Create API Key」**

4. **複製 API Key**
   - 格式類似：`AIzaSyXXXXXXXXXXXXXXXXXXXXXXXXXXXXX`

### 步驟 2：設定 API Key

**方法 A：直接設定（推薦）**
```bash
export GEMINI_API_KEY="your-api-key-here"
```

**方法 B：使用 .env 文件**
```bash
cd book-version
echo 'GEMINI_API_KEY=your-api-key-here' > .env
source .env
```

**驗證設定：**
```bash
echo $GEMINI_API_KEY
# 應該顯示你的 API Key
```

### 步驟 3：執行翻譯

```bash
cd book-version
./translate.sh
```

**就這麼簡單！** 🎉

---

## 📖 詳細說明

### 系統架構

```
翻譯系統
├── translate.sh           # 主執行腳本
├── scripts/
│   └── translate-to-english.js  # 翻譯邏輯
├── config/
│   └── book-config-en.yaml      # 英文版配置
└── manuscript-en/         # 輸出目錄
    ├── chapter-00.md
    ├── chapter-01.md
    └── ...
```

### 翻譯流程

```
1. 讀取配置
   ↓
2. 讀取中文章節
   ↓
3. 呼叫 Gemini API
   ↓
4. 翻譯成英文
   ↓
5. 儲存到 manuscript-en/
   ↓
6. 生成 Book.txt
```

### 翻譯特色

**保持格式：**
- ✅ Markdown 語法
- ✅ 標題、列表、連結
- ✅ 程式碼區塊
- ✅ Emoji 表情符號

**術語一致：**
- 規格驅動開發 → Spec-Driven Development (SDD)
- 非工程師 → non-engineers
- AI 工具 → AI tools
- 實戰專案 → hands-on projects

**智能處理：**
- 自動分段（長文本）
- 避免 API 限制（自動暫停）
- 錯誤處理和重試

---

## 💰 成本估算

### Gemini API 定價

**免費額度：**
- 每分鐘 60 次請求
- 每天 1,500 次請求
- **完全免費！**

**付費方案（如需要）：**
- $0.00025 / 1K 字元（輸入）
- $0.0005 / 1K 字元（輸出）

**本書預估：**
- 總字數：約 30,000 字
- 預估成本：**$0.50 - $2.00**
- 使用免費額度：**$0**

---

## ⏱️ 時間估算

### 翻譯時間

| 章節數 | 預估時間 | 說明 |
|--------|---------|------|
| 1-5 章 | 5-10 分鐘 | 快速完成 |
| 6-10 章 | 10-20 分鐘 | 中等時間 |
| 11-18 章 | 20-30 分鐘 | 完整翻譯 |

**影響因素：**
- 章節長度
- 網路速度
- API 回應時間
- 自動暫停時間

---

## 🔧 進階設定

### 自定義翻譯提示詞

編輯 `scripts/translate-to-english.js`：

```javascript
const TRANSLATION_PROMPT = `
// 在這裡修改翻譯指示
// 例如：調整語氣、風格、術語等
`;
```

### 調整 API 參數

```javascript
generationConfig: {
  temperature: 0.3,  // 0-1，越低越一致
  topK: 40,
  topP: 0.95,
  maxOutputTokens: 8192,
}
```

### 修改分段大小

```javascript
const maxChunkSize = 4000;  // 調整每次翻譯的字元數
```

### 調整暫停時間

```javascript
await sleep(3000);  // 調整暫停時間（毫秒）
```

---

## 🐛 故障排除

### 問題 1：找不到 API Key

**錯誤訊息：**
```
❌ 錯誤：找不到 GEMINI_API_KEY
```

**解決方案：**
```bash
# 重新設定 API Key
export GEMINI_API_KEY="your-api-key-here"

# 驗證
echo $GEMINI_API_KEY
```

### 問題 2：API 錯誤

**錯誤訊息：**
```
❌ 翻譯錯誤: API 錯誤: 429
```

**原因：** 超過 API 限制

**解決方案：**
1. 等待 1 分鐘
2. 重新執行
3. 或增加暫停時間

### 問題 3：翻譯不完整

**症狀：** 某些章節沒有翻譯

**解決方案：**
```bash
# 查看錯誤訊息
./translate.sh 2>&1 | tee translation.log

# 手動翻譯失敗的章節
node scripts/translate-to-english.js
```

### 問題 4：格式錯誤

**症狀：** 翻譯後格式跑掉

**解決方案：**
1. 檢查原始文件格式
2. 調整翻譯提示詞
3. 手動修正格式

### 問題 5：術語不一致

**症狀：** 同一術語有不同翻譯

**解決方案：**
1. 編輯 `translate-to-english.js`
2. 在 `TRANSLATION_PROMPT` 中加入術語對照
3. 重新翻譯

---

## ✅ 品質檢查

### 翻譯完成後檢查清單

**格式檢查：**
- [ ] 標題層級正確
- [ ] 列表格式正確
- [ ] 程式碼區塊完整
- [ ] 連結有效
- [ ] Emoji 保留

**內容檢查：**
- [ ] 術語一致
- [ ] 語意正確
- [ ] 語氣適當
- [ ] 無機器翻譯痕跡

**技術檢查：**
- [ ] 程式碼未被翻譯
- [ ] 指令正確
- [ ] 檔案路徑正確
- [ ] 工具名稱正確

### 檢查工具

**快速檢查：**
```bash
# 查看第一章
cat manuscript-en/chapter-01.md | head -50

# 搜尋特定術語
grep -r "Spec-Driven Development" manuscript-en/

# 統計章節數
ls -1 manuscript-en/chapter-*.md | wc -l
```

**詳細檢查：**
```bash
# 比對中英文
diff <(cat 模組內容/模組0_規格驅動思維.md) \
     <(cat manuscript-en/chapter-01.md)
```

---

## 📝 手動調整

### 常見需要調整的地方

**1. 文化差異**
```markdown
# 中文
例如：「雙十一購物節」

# 英文（需調整）
例如：「Black Friday shopping event」
```

**2. 範例調整**
```markdown
# 中文
例如：「台北 101」

# 英文（需調整）
例如：「Empire State Building」
```

**3. 語氣調整**
```markdown
# 機器翻譯
You should do this.

# 調整後
We recommend doing this.
```

### 批次修正

**使用 sed：**
```bash
# 批次替換術語
sed -i '' 's/program code/code/g' manuscript-en/*.md

# 批次調整格式
sed -i '' 's/## 🎯/## 🎯 /g' manuscript-en/*.md
```

---

## 🎯 最佳實踐

### 翻譯前

1. **確認配置正確**
   ```bash
   cat config/book-config-en.yaml
   ```

2. **備份原始文件**
   ```bash
   cp -r manuscript-en manuscript-en.backup
   ```

3. **測試 API**
   ```bash
   # 只翻譯一章測試
   # 修改腳本暫時只處理第一章
   ```

### 翻譯中

1. **監控進度**
   ```bash
   # 另開終端機
   watch -n 5 'ls -1 manuscript-en/*.md | wc -l'
   ```

2. **檢查錯誤**
   ```bash
   # 即時查看日誌
   tail -f translation.log
   ```

### 翻譯後

1. **完整檢查**
   - 通讀至少 3 章
   - 檢查術語一致性
   - 測試程式碼範例

2. **請他人審閱**
   - 母語人士
   - 技術背景人士
   - 目標讀者

3. **持續改進**
   - 收集反饋
   - 調整提示詞
   - 重新翻譯（如需要）

---

## 📤 上傳到 Leanpub

### 準備文件

```bash
# 確認所有文件都已翻譯
ls manuscript-en/

# 應該看到：
# - Book.txt
# - chapter-00.md
# - chapter-01.md
# - ... (所有章節)
```

### 上傳步驟

1. **登入 Leanpub**
   ```
   https://leanpub.com
   ```

2. **創建新書**
   - Title: Coding with AI: A Non-Engineer's Guide
   - Subtitle: Master Programming in 8 Weeks Using Spec-Driven Development

3. **選擇同步方式**
   - GitHub（推薦）
   - Dropbox
   - 手動上傳

4. **上傳文件**
   ```bash
   # 如果使用 GitHub
   git add manuscript-en/
   git commit -m "Add English translation"
   git push origin main
   
   # 如果手動上傳
   zip -r manuscript-en.zip manuscript-en/
   # 上傳到 Leanpub
   ```

5. **生成預覽**
   - 點擊 "Preview"
   - 等待 2-5 分鐘
   - 下載 PDF/EPUB

6. **檢查預覽**
   - 格式正確
   - 圖片顯示
   - 連結有效

7. **發布**
   - 設定價格
   - 上傳封面
   - 點擊 "Publish"

---

## 💡 進階技巧

### 批次翻譯特定章節

編輯 `translate-to-english.js`：

```javascript
// 只翻譯特定章節
const chaptersToTranslate = [1, 2, 3];

for (let i = 0; i < chapters.length; i++) {
  const chapter = chapters[i];
  if (!chaptersToTranslate.includes(chapter.chapter_number)) {
    continue;  // 跳過
  }
  // ... 翻譯邏輯
}
```

### 使用翻譯記憶

創建術語庫：

```javascript
const glossary = {
  '規格驅動開發': 'Spec-Driven Development (SDD)',
  '非工程師': 'non-engineers',
  'AI 工具': 'AI tools',
  // ... 更多術語
};

// 在翻譯前先替換
function preprocessText(text) {
  let result = text;
  for (const [chinese, english] of Object.entries(glossary)) {
    result = result.replace(new RegExp(chinese, 'g'), english);
  }
  return result;
}
```

### 平行翻譯（加速）

```javascript
// 使用 Promise.all 平行處理
const promises = chapters.map(chapter => 
  translateChapter(chapter, chapter.chapter_number)
);

await Promise.all(promises);
```

**注意：** 可能超過 API 限制，需要控制並發數量

---

## 📊 翻譯統計

### 生成統計報告

創建 `stats.sh`：

```bash
#!/bin/bash

echo "翻譯統計報告"
echo "============"
echo ""

# 章節數
CHAPTER_COUNT=$(ls -1 manuscript-en/chapter-*.md 2>/dev/null | wc -l)
echo "已翻譯章節：$CHAPTER_COUNT"

# 總字數
TOTAL_WORDS=$(cat manuscript-en/*.md 2>/dev/null | wc -w)
echo "總字數：$TOTAL_WORDS"

# 平均每章字數
AVG_WORDS=$((TOTAL_WORDS / CHAPTER_COUNT))
echo "平均每章：$AVG_WORDS 字"

# 檔案大小
TOTAL_SIZE=$(du -sh manuscript-en/ | cut -f1)
echo "總大小：$TOTAL_SIZE"

echo ""
echo "完成度："
EXPECTED_CHAPTERS=18
PROGRESS=$((CHAPTER_COUNT * 100 / EXPECTED_CHAPTERS))
echo "$PROGRESS% ($CHAPTER_COUNT/$EXPECTED_CHAPTERS)"
```

---

## 🎉 總結

### 你現在擁有

✅ **完整的自動翻譯系統**
- Gemini API 整合
- 智能分段處理
- 格式保持
- 術語一致

✅ **簡單的使用流程**
```bash
1. 取得 API Key
2. export GEMINI_API_KEY="..."
3. ./translate.sh
4. 完成！
```

✅ **高品質輸出**
- 保持原始格式
- 術語一致
- 適當語氣
- 可直接使用

### 立即開始

```bash
# 1. 取得 API Key
open https://makersuite.google.com/app/apikey

# 2. 設定 API Key
export GEMINI_API_KEY="your-api-key-here"

# 3. 執行翻譯
cd book-version
./translate.sh

# 4. 等待完成（10-30 分鐘）

# 5. 檢查結果
cat manuscript-en/chapter-01.md

# 6. 上傳 Leanpub
# 完成！
```

---

**🎊 準備好開始翻譯了嗎？**

**只需 3 個指令：**

```bash
export GEMINI_API_KEY="your-api-key-here"
cd book-version
./translate.sh
```

**就這麼簡單！** 🚀

---

**建立日期：** 2024-10-18  
**版本：** 1.0.0  
**狀態：** ✅ 可立即使用
