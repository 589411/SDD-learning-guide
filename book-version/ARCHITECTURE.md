# ğŸ—ï¸ ç³»çµ±æ¶æ§‹èªªæ˜

## ğŸ“ æ•´é«”æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         SDD å­¸ç¿’æŒ‡å—å°ˆæ¡ˆ                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                           â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   GitHub Repo       â”‚     â”‚   æ›¸ç±ç”Ÿæˆç³»çµ±      â”‚
         â”‚   (å­¸ç¿’å¹³å°)         â”‚     â”‚   (å‡ºç‰ˆç³»çµ±)        â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                           â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ æ¨¡çµ„åŒ–å…§å®¹           â”‚â”€â”€â”€â”€â–¶â”‚ é…ç½®é©…å‹•ç”Ÿæˆ        â”‚
         â”‚ - æ¨¡çµ„ 0-4          â”‚     â”‚ - book-config.yaml â”‚
         â”‚ - å¯¦æˆ°å°ˆæ¡ˆ          â”‚     â”‚ - è‡ªå‹•åŒ–è…³æœ¬        â”‚
         â”‚ - å­¸ç¿’è³‡æº          â”‚     â”‚ - ç« ç¯€æ¨¡æ¿          â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                               â”‚
                                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                     â”‚ è¼¸å‡ºæ ¼å¼            â”‚
                                     â”‚ - Leanpub          â”‚
                                     â”‚ - å‡ºç‰ˆç¤¾æ ¼å¼        â”‚
                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ æ•¸æ“šæµç¨‹

```
1. ä¾†æºå…§å®¹                2. é…ç½®è™•ç†              3. ç”Ÿæˆè¼¸å‡º
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ¨¡çµ„0.md    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ è®€å–é…ç½®    â”‚          â”‚ chapter-01  â”‚
â”‚ æ¨¡çµ„1.md    â”‚           â”‚ book-config â”‚          â”‚ chapter-02  â”‚
â”‚ å°ˆæ¡ˆ1/      â”‚           â”‚             â”‚          â”‚ ...         â”‚
â”‚ å°ˆæ¡ˆ2/      â”‚           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ å°ˆæ¡ˆ3/      â”‚                  â”‚                          â–²
â”‚ å­¸ç¿’è³‡æº/   â”‚                  â”‚                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚                          â”‚
                                 â”‚                          â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
                        â”‚ è™•ç†ç« ç¯€å…§å®¹    â”‚                 â”‚
                        â”‚ - æå–æ¨™é¡Œ      â”‚                 â”‚
                        â”‚ - è¨ˆç®—æ™‚é–“      â”‚                 â”‚
                        â”‚ - æ·»åŠ å…ƒç´       â”‚                 â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
                                 â”‚                          â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
                        â”‚ æ¸²æŸ“ç« ç¯€        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚ - å¥—ç”¨æ¨¡æ¿      â”‚
                        â”‚ - æ ¼å¼åŒ–å…§å®¹    â”‚
                        â”‚ - ç”Ÿæˆç´¢å¼•      â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ æ¨¡çµ„æ¶æ§‹

### 1. é…ç½®å±¤ (Configuration Layer)

```
config/
â”œâ”€â”€ book-config.yaml        # æ ¸å¿ƒé…ç½®
â”‚   â”œâ”€â”€ book_metadata       # æ›¸ç±å…ƒæ•¸æ“š
â”‚   â”œâ”€â”€ book_structure      # ç« ç¯€çµæ§‹
â”‚   â”‚   â”œâ”€â”€ part0-4        # å„éƒ¨åˆ†å®šç¾©
â”‚   â”‚   â””â”€â”€ appendix       # é™„éŒ„å®šç¾©
â”‚   â”œâ”€â”€ interactive_elements # äº’å‹•å…ƒç´ æ¨¡æ¿
â”‚   â””â”€â”€ generation_options  # ç”Ÿæˆé¸é …
â”‚
â”œâ”€â”€ metadata.yaml           # æ›¸ç±å…ƒæ•¸æ“š
â”‚   â”œâ”€â”€ book               # åŸºæœ¬è³‡è¨Š
â”‚   â”œâ”€â”€ publication        # å‡ºç‰ˆè³‡è¨Š
â”‚   â”œâ”€â”€ target_audience    # ç›®æ¨™è®€è€…
â”‚   â””â”€â”€ marketing          # è¡ŒéŠ·è³‡è¨Š
â”‚
â””â”€â”€ chapter-template.md     # ç« ç¯€æ¨¡æ¿
    â”œâ”€â”€ æ¨™é¡Œå€
    â”œâ”€â”€ å­¸ç¿’ç›®æ¨™
    â”œâ”€â”€ æ ¸å¿ƒå…§å®¹
    â”œâ”€â”€ å¯¦ä½œä»»å‹™
    â””â”€â”€ æª¢æ¸¬æ¸…å–®
```

### 2. è™•ç†å±¤ (Processing Layer)

```
scripts/
â”œâ”€â”€ generate-book.js        # ä¸»è¦ç”Ÿæˆé‚è¼¯
â”‚   â”œâ”€â”€ generateBook()     # ä¸»å‡½æ•¸
â”‚   â”œâ”€â”€ generatePart()     # ç”Ÿæˆéƒ¨åˆ†
â”‚   â”œâ”€â”€ generateChapter()  # ç”Ÿæˆç« ç¯€
â”‚   â”œâ”€â”€ renderChapter()    # æ¸²æŸ“ç« ç¯€
â”‚   â””â”€â”€ generateReport()   # ç”Ÿæˆå ±å‘Š
â”‚
â”œâ”€â”€ utils.js               # å·¥å…·å‡½æ•¸
â”‚   â”œâ”€â”€ loadConfig()       # è¼‰å…¥é…ç½®
â”‚   â”œâ”€â”€ loadMarkdownFile() # è®€å– Markdown
â”‚   â”œâ”€â”€ calculateReadingTime() # è¨ˆç®—æ™‚é–“
â”‚   â”œâ”€â”€ extractTitle()     # æå–æ¨™é¡Œ
â”‚   â”œâ”€â”€ generateBookTxt()  # ç”Ÿæˆç´¢å¼•
â”‚   â””â”€â”€ validateConfig()   # é©—è­‰é…ç½®
â”‚
â””â”€â”€ validate-config.js     # é…ç½®é©—è­‰
    â”œâ”€â”€ validateConfiguration()
    â”œâ”€â”€ checkChapters()
    â””â”€â”€ checkFiles()
```

### 3. è¼¸å‡ºå±¤ (Output Layer)

```
manuscript/                 # Leanpub è¼¸å‡º
â”œâ”€â”€ Book.txt               # ç« ç¯€é †åºï¼ˆå¿…éœ€ï¼‰
â”œâ”€â”€ Sample.txt             # è©¦é–±ç« ç¯€
â”œâ”€â”€ part0.md               # éƒ¨åˆ†æ¨™é¡Œé 
â”œâ”€â”€ chapter-01.md          # ç« ç¯€å…§å®¹
â”œâ”€â”€ chapter-02.md
â”œâ”€â”€ ...
â”œâ”€â”€ appendix-A.md          # é™„éŒ„
â””â”€â”€ REPORT.md              # ç”Ÿæˆå ±å‘Š

output/                    # å…¶ä»–æ ¼å¼è¼¸å‡º
â””â”€â”€ publisher/             # å‡ºç‰ˆç¤¾æ ¼å¼
    â”œâ”€â”€ book.docx          # Word æ ¼å¼
    â””â”€â”€ book.pdf           # PDF æ ¼å¼
```

## ğŸ”§ æ ¸å¿ƒçµ„ä»¶

### 1. é…ç½®è§£æå™¨ (Config Parser)

```javascript
// åŠŸèƒ½ï¼šè®€å–å’Œé©—è­‰é…ç½®
class ConfigParser {
  loadConfig(path)          // è¼‰å…¥ YAML é…ç½®
  validateConfig(config)    // é©—è­‰é…ç½®æ ¼å¼
  resolveReferences()       // è§£æå¼•ç”¨é—œä¿‚
}
```

### 2. å…§å®¹è™•ç†å™¨ (Content Processor)

```javascript
// åŠŸèƒ½ï¼šè™•ç†ä¾†æºå…§å®¹
class ContentProcessor {
  loadSourceFile(path)      // è¼‰å…¥ä¾†æºæ–‡ä»¶
  extractMetadata()         // æå–å…ƒæ•¸æ“š
  calculateReadingTime()    // è¨ˆç®—é–±è®€æ™‚é–“
  processMarkdown()         // è™•ç† Markdown
}
```

### 3. ç« ç¯€ç”Ÿæˆå™¨ (Chapter Generator)

```javascript
// åŠŸèƒ½ï¼šç”Ÿæˆç« ç¯€å…§å®¹
class ChapterGenerator {
  generateChapter(config)   // ç”Ÿæˆç« ç¯€
  addInteractiveElements()  // æ·»åŠ äº’å‹•å…ƒç´ 
  renderTemplate()          // æ¸²æŸ“æ¨¡æ¿
  formatOutput()            // æ ¼å¼åŒ–è¼¸å‡º
}
```

### 4. è¼¸å‡ºç®¡ç†å™¨ (Output Manager)

```javascript
// åŠŸèƒ½ï¼šç®¡ç†è¼¸å‡ºæ–‡ä»¶
class OutputManager {
  writeChapter(content)     // å¯«å…¥ç« ç¯€
  generateBookTxt()         // ç”Ÿæˆç´¢å¼•
  generateReport()          // ç”Ÿæˆå ±å‘Š
  cleanupOutput()           // æ¸…ç†è¼¸å‡º
}
```

## ğŸ¯ è¨­è¨ˆæ¨¡å¼

### 1. é…ç½®é©…å‹• (Configuration-Driven)

```yaml
# æ‰€æœ‰å…§å®¹é€šéé…ç½®å®šç¾©
chapters:
  - chapter_number: 1
    source_file: "../æ¨¡çµ„0.md"
    include_elements: ["objectives", "tasks"]
```

**å„ªé»ï¼š**
- æ˜“æ–¼èª¿æ•´
- å¯é‡è¤‡ä½¿ç”¨
- é™ä½è€¦åˆ

### 2. æ¨¡æ¿å¼•æ“ (Template Engine)

```javascript
// ä½¿ç”¨æ¨¡æ¿æ¸²æŸ“ç« ç¯€
const template = loadTemplate('chapter-template.md');
const output = renderTemplate(template, data);
```

**å„ªé»ï¼š**
- çµ±ä¸€æ ¼å¼
- æ˜“æ–¼ç¶­è­·
- æ”¯æŒè‡ªå®šç¾©

### 3. ç®¡é“è™•ç† (Pipeline Processing)

```javascript
// ç« ç¯€ç”Ÿæˆç®¡é“
source â†’ load â†’ process â†’ enhance â†’ render â†’ output
```

**å„ªé»ï¼š**
- æ¸…æ™°çš„æµç¨‹
- æ˜“æ–¼æ“´å±•
- ä¾¿æ–¼æ¸¬è©¦

## ğŸ”Œ æ“´å±•é»

### 1. æ–°å¢äº’å‹•å…ƒç´ 

```javascript
// åœ¨ book-config.yaml å®šç¾©
interactive_elements:
  new_element:
    template: "..."

// åœ¨ generate-book.js å¯¦ç¾
function addNewElement(data, config) {
  // è™•ç†é‚è¼¯
}
```

### 2. æ”¯æŒæ–°æ ¼å¼

```javascript
// å‰µå»ºæ–°çš„ç”Ÿæˆå™¨
class PDFGenerator extends BaseGenerator {
  generate(chapters) {
    // PDF ç”Ÿæˆé‚è¼¯
  }
}
```

### 3. è‡ªå®šç¾©è™•ç†å™¨

```javascript
// è¨»å†Šè‡ªå®šç¾©è™•ç†å™¨
processors.register('custom', (content) => {
  // è‡ªå®šç¾©è™•ç†é‚è¼¯
  return processedContent;
});
```

## ğŸ“Š æ€§èƒ½è€ƒé‡

### 1. æ–‡ä»¶ç·©å­˜

```javascript
// ç·©å­˜å·²è®€å–çš„æ–‡ä»¶
const fileCache = new Map();

function loadFile(path) {
  if (fileCache.has(path)) {
    return fileCache.get(path);
  }
  // è®€å–ä¸¦ç·©å­˜
}
```

### 2. ä¸¦è¡Œè™•ç†

```javascript
// ä¸¦è¡Œç”Ÿæˆå¤šå€‹ç« ç¯€
const chapters = await Promise.all(
  configs.map(config => generateChapter(config))
);
```

### 3. å¢é‡æ›´æ–°

```javascript
// åªæ›´æ–°ä¿®æ”¹éçš„ç« ç¯€
if (isModified(sourceFile, outputFile)) {
  regenerateChapter(config);
}
```

## ğŸ”’ å®‰å…¨æ€§

### 1. è·¯å¾‘é©—è­‰

```javascript
// é˜²æ­¢è·¯å¾‘éæ­·æ”»æ“Š
function validatePath(path) {
  const resolved = path.resolve(basePath, path);
  if (!resolved.startsWith(basePath)) {
    throw new Error('Invalid path');
  }
}
```

### 2. è¼¸å…¥é©—è­‰

```javascript
// é©—è­‰é…ç½®è¼¸å…¥
function validateInput(config) {
  // æª¢æŸ¥å¿…è¦æ¬„ä½
  // é©—è­‰æ•¸æ“šé¡å‹
  // æ¸…ç†å±éšªå…§å®¹
}
```

## ğŸ§ª æ¸¬è©¦ç­–ç•¥

### 1. å–®å…ƒæ¸¬è©¦

```javascript
// æ¸¬è©¦å·¥å…·å‡½æ•¸
describe('utils', () => {
  test('calculateReadingTime', () => {
    const result = calculateReadingTime('...');
    expect(result.minutes).toBe(5);
  });
});
```

### 2. æ•´åˆæ¸¬è©¦

```javascript
// æ¸¬è©¦å®Œæ•´æµç¨‹
describe('generateBook', () => {
  test('generates all chapters', async () => {
    const result = await generateBook(config);
    expect(result.chapters.length).toBe(10);
  });
});
```

### 3. ç«¯å°ç«¯æ¸¬è©¦

```javascript
// æ¸¬è©¦å¯¦éš›è¼¸å‡º
describe('e2e', () => {
  test('generates valid Leanpub format', () => {
    generateBook(config);
    const bookTxt = readFile('manuscript/Book.txt');
    expect(bookTxt).toContain('chapter-01.md');
  });
});
```

## ğŸ“ˆ ç›£æ§èˆ‡æ—¥èªŒ

### 1. é€²åº¦è¿½è¹¤

```javascript
// é¡¯ç¤ºç”Ÿæˆé€²åº¦
showProgress(current, total, 'Generating chapters...');
```

### 2. éŒ¯èª¤è™•ç†

```javascript
// çµ±ä¸€éŒ¯èª¤è™•ç†
try {
  generateChapter(config);
} catch (error) {
  logger.error('Failed to generate chapter', error);
  // å›æ»¾æˆ–è·³é
}
```

### 3. çµ±è¨ˆå ±å‘Š

```javascript
// ç”Ÿæˆè©³ç´°å ±å‘Š
const report = {
  totalChapters: 10,
  totalReadingTime: 300,
  generatedAt: new Date()
};
```

---

## ğŸ“ æœ€ä½³å¯¦è¸

1. **é…ç½®å„ªå…ˆ**ï¼šæ‰€æœ‰å¯è®Šå…§å®¹é€šéé…ç½®å®šç¾©
2. **æ¨¡çµ„åŒ–è¨­è¨ˆ**ï¼šæ¯å€‹çµ„ä»¶è·è²¬å–®ä¸€
3. **éŒ¯èª¤è™•ç†**ï¼šå®Œå–„çš„éŒ¯èª¤è™•ç†å’Œå›æ»¾æ©Ÿåˆ¶
4. **æ–‡æª”å®Œæ•´**ï¼šæ¯å€‹å‡½æ•¸éƒ½æœ‰æ¸…æ™°çš„è¨»è§£
5. **å¯æ¸¬è©¦æ€§**ï¼šè¨­è¨ˆæ™‚è€ƒæ…®æ¸¬è©¦éœ€æ±‚

---

**ç›¸é—œæ–‡æª”ï¼š**
- `HOW_IT_WORKS.md` - é‹ä½œåŸç†
- `QUICK_START.md` - å¿«é€Ÿé–‹å§‹
- `SUMMARY.md` - ç³»çµ±ç¸½çµ
